# 第4章：C程式語言回顧

## 4.1 資料型別和變數

介紹C語言中的各種資料型別和變數的定義、聲明、賦值、運算等基本概念和操作，包括整型、浮點型、字符型、指標型等。

在C程式中，變數是指一塊用於儲存數據的內存空間，而資料型別則是指該內存空間儲存的數據類型。在C程式中，資料型別分為：基本型別和結構型別兩種。

### 4.1.1 基本型別

包括整型(short int、int 或 long int
)、字符型(char)、浮點型(float 或 double
)和雙精度型，其中整型可以進一步分為有符號整型和無符號整型。

有符號整型和無符號整型都是整數數據類型，它們在計算機中表示整數值。它們之間的區別在於對於有符號整型，最高位用於表示符號，0表示正數，1表示負數，而無符號整型則全部位數都用於表示值，沒有符號位。

1. 有符號整型：
    
    (1)包括：int、short、long 和 long long
    
    (2)它們在不同的編譯器和平台上可能有不同的長度
    
    *wul在32位編譯器上，int一般是4個字節，即32位; 在64位編譯器上，int一般是8個字節，即64位*
    
    (3)對於需要表示負數的場景，必須使用有符號整型

2. 無符號整型：
    
    (1)也包括無符號的 int、short、long 和 long long
    
    (2)它們的長度也可能因編譯器和平台的不同而不同
    
    (3)可以表示的最大值是有符號整型的兩倍，但無法表示負數
    
    *在使用無符號整型時，需要注意溢出問題，因為無符號整型不會自動轉換為有符號整型，可能會導致意外的結果。*


### 4.1.2 結構型別（structure）

在C語言中，結構型別是一種自定義的複合型別，可以用來組織和管理不同類型的變量。它由多個不同的變量組成，這些變量可以是基本型別、結構型別、指標或其他複合型別。

結構型別通常由關聯性較強的變量組成，例如一個學生結構體可以包含姓名、年齡、學號等多個變量。結構型別中的變量可以使用 "." 運算符來訪問。

結構型別的定義由關鍵字 "struct" 開始，之後是結構名稱，然後是一對大括號{}包含的變量列表。例如，下面是一個表示學生的結構體的定義：
```
struct student {
   char name[20];
   int age;
   int id;
};
```
在上述定義中，"struct student"定義了一個學生結構體，它由三個變量組成：姓名、年齡和學號。

### 4.1.3 變數聲明與指針變數

在C程式中，變數聲明通常會包括變數的「名稱」和「資料型別」。例如， int a 表示聲明了一個整型變數 a，char b 表示聲明了一個字符型變數 b，而 struct student s 表示聲明了一個結構型別變數 s，其結構體成員可以透過 s.成員名稱的方式訪問。

此外，C程式中還有指針變數，指針變數可以儲存變數的地址，也可以動態分配內存空間。例如， int *p 表示聲明了一個整型指針變數 p，可以透過 *p 的方式訪問指針所指向的變數的值。指針變數在C程式中使用頻繁，是C程式中的重要概念。


## 4.2 控制結構

在C語言中，控制結構是一種能夠控制程式執行流程的語句，它可以根據特定的條件來決定程式要執行哪些語句，從而實現對程式執行的控制和調整。常見的控制結構有:
1. 條件語句： if、else、switch
2. 循環語句： for、while、do-while
3. 跳轉語句： break、continue、goto、return

### 4.2.1 條件語句

用於根據某個條件的真假情況，來判斷是否執行相應的程式碼塊。其中，if語句只判斷一次，而if-else語句可以判斷兩種情況，switch語句可以判斷多種情況。

### 4.2.2 循環語句

用於根據特定的條件，反覆執行某段程式碼，直到條件不滿足為止。其中，for循環是在已知循環次數的情況下使用，while循環和do-while循環則是在未知循環次數的情況下使用。

### 4.2.3 跳轉語句

用於控制程式的跳轉和返回，可以讓程式在執行過程中跳過某些語句，或者直接跳轉到程序的任意位置。其中，break語句可以用於終止循環，continue語句可以用於跳過循環中的某次迭代，goto語句可以用於直接跳轉到指定的標籤位置，return語句可以用於從函數中返回值。

控制結構是C語言中最基本的程式控制結構，它可以根據不同的情況進行程式流程控制，使程式具有更大的靈活性和可擴展性，從而可以更好地實現複雜的程式邏輯和功能。


## 4.3 函數和指標

### 4.3.1 函數的定義

函數是一段可以重複使用的程式碼塊，可以將函數視為一個子程序，可在程式中的多個地方調用並執行。在C程式中，函數定義由函數名稱、函數返回值類型、函數參數列表和函數體組成。例如：
```
int add(int a, int b) {
    return a + b;
}
```
上述代碼定義了一個名為add的函數，該函數接受兩個整型參數a和b，並返回它們的和。

### 4.3.2 函數的參數傳遞
是指向函數傳遞數據的過程。在C程式中，有兩種方式傳遞參數，分別是值傳遞和指針傳遞。

1. 值傳遞：將實際參數的值複製到函數的形式參數中，當函數執行結束後，形式參數的值不會對實際參數產生影響。

2. 指針傳遞：將實際參數的地址傳遞給函數，函數中可以通過該地址訪問參數的值，並且對該地址上的值的修改將對實際參數產生影響。

### 4.3.3 指標的定義和使用

指標是一種變數，其值為某個變數的地址，可以使用運算符&取得變數的地址，使用運算符*取得指標所指向的變數的值。可以使用指標變數來存儲和操作變量的地址，以實現對變量的間接訪問，或者動態分配內存空間，實現動態數據結構，也可以優化一些算法的實現方式。

指標可以用於傳遞變數的地址，從而可以在函數中修改原始變數的值，可以通過函數的參數列表來定義指向某種特定型別的指標，從而在函數中使用指標來訪問和修改相應型別的變數。此外，可以通過指標來實現動態分配內存空間，即在程序運行時根據需要分配內存空間。

指標也是C語言中的一個重要概念，使用指標需要注意指標的類型和指標所指向的內存空間的有效性等問題。

## 4.4 標準庫函數

標準庫函數是一組在C程式中可以使用的函數庫，包括標準I/O、字符串處理、數學運算、日期和時間等方面的函數。這些函數在不同的C編譯器和操作系統中都有相同的定義和用法，並且經過了廣泛的測試和驗證，被視為安全和可靠的。

標準庫函數由C語言標準庫提供，可以通過在程式中包含相應的頭文件來使用。例如，stdio.h頭文件中包含了標準I/O函數，string.h頭文件中包含了字串處理函數等。標準庫函數通常使用簡單的接口，可以方便地在程式中調用，並且有詳細的文檔和示例，便於開發者使用和學習。

1. 數學函數：
包括許多與數學運算有關的函數，如三角函數、指數函數、對數函數等等。使用數學函數需要引入數學標頭文件，例如 math.h。常見的數學函數包括 sin()、cos()、tan()、exp()、log() 等。

2. 字串處理函數：
用於處理字符數組（即字符串），可以用於拷貝、比較、查找和修改字符串等操作。常用的字串處理函數包括 strcpy()、strlen()、strcmp()、strcat() 等。需要引入字符串標頭文件 string.h。

3. 文件操作函數：
用於讀取和寫入文件，可以用於創建、打開、關閉、讀取和寫入文件等操作。常用的文件操作函數包括 fopen()、fclose()、fread()、fwrite() 等。需要引入文件操作標頭文件 stdio.h。

在C程式開發中，標準庫函數被廣泛使用，能夠大大簡化程式開發的工作量。但是，有些標準庫函數可能效率較低，需要注意在實際應用中選擇合適的函數。

在使用標準庫函數時，需要注意以下幾點：

1. 函數的參數類型和數量必須符合函數的要求。

2. 函數的返回值類型必須與函數的要求相匹配。

3. 函數的參數在傳遞時可以是值傳遞或指針傳遞，需要根據函數的要求進行選擇。

4. 函數的使用需要了解其功能和使用方法，並根據實際需要進行調用。

5. 某些函數可能具有不同的實現，需要根據不同的操作系統或編譯器進行選擇。

6. 在使用涉及內存操作的函數時，需要注意內存分配和釋放，避免內存洩漏或訪問非法內存。

7. 在使用涉及文件操作的函數時，需要注意文件的打開和關閉，避免文件操作異常。

## 4.5 編譯和調試

介紹C語言的編譯和調試流程，包括編譯器、編譯過程、調試器、調試方法等，並講解各種編譯和調試技巧和注意事項。

### 4.5.1 C語言的編譯流程

編譯器是一種將高級語言代碼轉換為機器碼的程式。在C語言中，編譯器負責將源代碼文件（通常以.c為擴展名）轉換為目標代碼文件（通常以.obj或.o為擴展名）。

1. 編寫C語言源文件（.c文件），可以使用任何一個編輯器，如：Visual Studio Code、Sublime Text、Notepad等。

2. 將源文件編譯成目標文件（.obj文件）：編譯器會將源文件轉換成中間代碼（.obj文件），可以使用C語言的編譯器，如：GCC、Clang等。

3. 將目標文件鏈接成可執行文件（.exe文件）：將所有的目標文件和函數庫文件進行鏈接，生成可執行文件，可以使用鏈接器，如：GCC、Clang等。

4. 執行可執行文件：將可執行文件在操作系統中運行。

在編譯過程中，可以通過各種參數設置來控制編譯器的行為，例如指定生成的目標文件類型、設置優化等級等。

編譯過程中常見的錯誤有語法錯誤、連接錯誤、內存泄漏等，可以通過調試工具（如gdb）對程序進行調試，定位並解決這些錯誤。

### 4.5.2 C語言的調試流程

在軟體開發過程中，除了編譯器將程式碼編譯成機器碼以外，還需要進行調試以保證程式碼的正確性。調試是指在程式運行時發現並解決問題的過程。

為了進行調試，開發人員需要使用調試器，調試器是一種特殊的軟體工具，可以幫助開發人員在程式運行時跟蹤程式碼的執行過程，並可以暫停程式運行，查看變數的值、堆棧的內容等等。

調試器可以在執行程序時對程序進行監控，以便找到錯誤和問題。常用的調試器包括GDB、LLDB、Visual Studio Debugger等等，開發人員可以根據自己的開發環境和需求選擇適合自己的調試器。


在進行調試時，開發者需要仔細檢查代碼中的語法、邏輯錯誤，以及在執行過程中可能出現的異常情況。在編譯和鏈接時，編譯器和鏈接器會生成警告和錯誤信息，這些信息可以幫助開發者找到代碼中的問題。

在進行調試時，開發人員可以使用各種方法來定位和解決問題，包括：

1. 斷點調試：在程式中設置斷點，讓程式運行到斷點處時暫停，方便開發人員查看變數值、堆棧內容等等。

2. 單步調試：在程式中設置一步步執行，方便開發人員查看程式的執行過程。

3. 資源監控：查看程式使用的資源，如CPU、內存等，可以幫助開發人員找到資源占用過高的問題。

4. 記錄調試：在程式運行時，將程式的執行過程和相關資訊記錄下來，方便開發人員後續分析。

調試是程式開發過程中非常重要的一部分，可以幫助開發人員發現和解決問題，提高程式的品質和穩定性。
